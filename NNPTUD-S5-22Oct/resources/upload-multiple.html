<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Upload Multiple Avatars</title>
  </head>
  <body>
    <h3>Upload Multiple Avatars (POST /api/users/me/avatars)</h3>
    <label
      >Token:
      <input
        id="token"
        style="width: 400px"
        placeholder="Bearer token or token string" /></label
    ><br /><br />
    <input type="file" id="files" accept="image/*" multiple /><br /><br />
    <button id="btn">Upload Multiple</button>
    <pre id="out"></pre>

    <script>
      document.getElementById("btn").addEventListener("click", async () => {
        const filesEl = document.getElementById("files");
        const token = document.getElementById("token").value.trim();
        if (!filesEl.files.length) {
          alert("Choose files");
          return;
        }

        const fd = new FormData();
        for (let i = 0; i < filesEl.files.length; i++)
          fd.append("avatars", filesEl.files[i]);

        const res = await fetch("/api/users/me/avatars", {
          method: "POST",
          headers: token
            ? {
                Authorization: token.startsWith("Bearer")
                  ? token
                  : "Bearer " + token,
              }
            : {},
          body: fd,
        });

        const json = await res.json();
        document.getElementById("out").textContent = JSON.stringify(
          json,
          null,
          2
        );
      });
    </script>
  </body>
</html>
